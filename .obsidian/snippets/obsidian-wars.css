/* ========== Obsidian Wars (skeleton) ========== */
/* 変数（色＆強さ） */
:root {
  --ow-glow: 0.75;               /* 発光強度（0~1） */
  --ow-star-opacity: 0.15;       /* 星空の濃さ */
  --ow-star-tint: 0, 150, 255;   /* 青めの星色 (R,G,B) */
  --ow-saber-thickness: 3px;     /* ライトセーバー線の太さ */
  --ow-saber-core: #ffffff;      /* ブレード中心の白 */
}

/* ライト（ジェダイ）：見出し＝青/緑 */
.theme-light {
  --ow-h1: #2ea8ff;  /* 青（オビ＝ワン） */
  --ow-h2: #41ff7c;  /* 緑（ヨーダ） */
  --ow-h3: #5ec7ff;
  --ow-h4: #6dff9a;
  --ow-h5: #9bd7ff;
  --ow-h6: #aaffc5;
}

/* ダーク（シス）：見出し＝赤系 */
.theme-dark {
  --ow-h1: #ff2e2e;  /* クリムゾン（ベイダー） */
  --ow-h2: #ff5252;
  --ow-h3: #ff6e6e;
  --ow-h4: #ff8a8a;
  --ow-h5: #ffa3a3;
  --ow-h6: #ffbcbc;
}

/* ===== 背景：ぼんやり星空 ===== */
body {
  /* 基本の背景はテーマ任せ＋星層を重ねる */
  background:
    radial-gradient(circle at 10% 20%, rgba(var(--ow-star-tint), var(--ow-star-opacity)) 0 1px, transparent 2px) 0 0 / 180px 180px,
    radial-gradient(circle at 70% 80%, rgba(var(--ow-star-tint), calc(var(--ow-star-opacity)*0.8)) 0 1px, transparent 2px) 0 0 / 220px 220px,
    radial-gradient(circle at 40% 60%, rgba(255,255,255, calc(var(--ow-star-opacity)*0.9)) 0 1px, transparent 2px) 0 0 / 260px 260px;
}

/* 動きをほんの少し（苦手な人はOS設定で止める） */
@media (prefers-reduced-motion: no-preference) {
  body {
    animation: ow-parallax 40s linear infinite;
  }
  @keyframes ow-parallax {
    0%   { background-position: 0 0, 0 0, 0 0; }
    100% { background-position: 200px 60px, -160px 100px, 120px -80px; }
  }
}

/* ===== 見出し：ジェダイ/シス配色＋淡い発光 ===== */
/* プレビュー（読み） */
.markdown-preview-view h1,
.markdown-preview-view h2,
.markdown-preview-view h3,
.markdown-preview-view h4,
.markdown-preview-view h5,
.markdown-preview-view h6 {
  letter-spacing: 0.02em;
  text-transform: none;
}

.markdown-preview-view h1 { color: var(--ow-h1); text-shadow: 0 0 6px color-mix(in oklab, var(--ow-h1) 60%, #fff 40%); }
.markdown-preview-view h2 { color: var(--ow-h2); text-shadow: 0 0 6px color-mix(in oklab, var(--ow-h2) 60%, #fff 40%); }
.markdown-preview-view h3 { color: var(--ow-h3); text-shadow: 0 0 5px color-mix(in oklab, var(--ow-h3) 60%, #fff 40%); }
.markdown-preview-view h4 { color: var(--ow-h4); text-shadow: 0 0 4px color-mix(in oklab, var(--ow-h4) 60%, #fff 40%); }
.markdown-preview-view h5 { color: var(--ow-h5); text-shadow: 0 0 3px color-mix(in oklab, var(--ow-h5) 60%, #fff 40%); }
.markdown-preview-view h6 { color: var(--ow-h6); text-shadow: 0 0 2px color-mix(in oklab, var(--ow-h6) 60%, #fff 40%); }

/* エディタ（Live Preview / CM6） */
.markdown-source-view.mod-cm6 .cm-content h1,
.markdown-source-view.mod-cm6 .cm-content h2,
.markdown-source-view.mod-cm6 .cm-content h3,
.markdown-source-view.mod-cm6 .cm-content h4,
.markdown-source-view.mod-cm6 .cm-content h5,
.markdown-source-view.mod-cm6 .cm-content h6 {
  /* CodeMirrorの見出しトークン色 */
  color: inherit;
}
.cm-header-1 { color: var(--ow-h1) !important; text-shadow: 0 0 6px color-mix(in oklab, var(--ow-h1) 60%, #fff 40%); }
.cm-header-2 { color: var(--ow-h2) !important; text-shadow: 0 0 6px color-mix(in oklab, var(--ow-h2) 60%, #fff 40%); }
.cm-header-3 { color: var(--ow-h3) !important; text-shadow: 0 0 5px color-mix(in oklab, var(--ow-h3) 60%, #fff 40%); }
.cm-header-4 { color: var(--ow-h4) !important; text-shadow: 0 0 4px color-mix(in oklab, var(--ow-h4) 60%, #fff 40%); }
.cm-header-5 { color: var(--ow-h5) !important; text-shadow: 0 0 3px color-mix(in oklab, var(--ow-h5) 60%, #fff 40%); }
.cm-header-6 { color: var(--ow-h6) !important; text-shadow: 0 0 2px color-mix(in oklab, var(--ow-h6) 60%, #fff 40%); }

/* ===== 区切り線（hr）：ライトセーバー風 ===== */
.markdown-preview-view hr,
.markdown-source-view.mod-cm6 hr {
  border: none;
  height: var(--ow-saber-thickness);
  background:
    /* コア（白） */
    linear-gradient(90deg, transparent, var(--ow-saber-core), transparent) center/100% 100% no-repeat,
    /* グロー（見出し1色を基調にするけど少し混ぜる） */
    radial-gradient(closest-side, rgba(255,255,255,0.6), transparent 60%) center/100% 140% no-repeat;
  position: relative;
  filter: drop-shadow(0 0 8px color-mix(in oklab, var(--ow-h1) 70%, #fff 30%))
          drop-shadow(0 0 14px color-mix(in oklab, var(--ow-h1) 50%, #fff 50%));
  border-radius: 999px;
  opacity: 0.95;
}

/* セーバーの“揺らぎ”をほんの少し */
@media (prefers-reduced-motion: no-preference) {
  .markdown-preview-view hr,
  .markdown-source-view.mod-cm6 hr {
    animation: ow-hum 2.2s ease-in-out infinite alternate;
  }
  @keyframes ow-hum {
    from { filter: drop-shadow(0 0 7px color-mix(in oklab, var(--ow-h1) 70%, #fff 30%)); }
    to   { filter: drop-shadow(0 0 12px color-mix(in oklab, var(--ow-h1) 70%, #fff 30%)); }
  }
}

/* ===== 見出し下に“水平セーバー”を出す（任意：h1だけ） ===== */
.markdown-preview-view h1::after {
  content: "";
  display: block;
  height: var(--ow-saber-thickness);
  margin-top: 6px;
  background: linear-gradient(90deg, transparent, var(--ow-saber-core), transparent);
  filter: drop-shadow(0 0 10px var(--ow-h1)) drop-shadow(0 0 16px var(--ow-h1));
  border-radius: 999px;
  opacity: 0.95;
}

/* ===== 読書用タイポ補助（日本語Noto Serif推奨） ===== */
body, .markdown-preview-view, .cm-s-obsidian {
  font-family: "Noto Serif JP", "Noto Serif CJK JP", "Hiragino Mincho ProN", "Yu Mincho", serif;
  line-height: 1.75;
}

/* ===== 互換性：古いブラウザで color-mix が無い場合の弱発光 ===== */
@supports not (color: color-mix(in oklab, red 50%, white 50%)) {
  .markdown-preview-view h1, .cm-header-1,
  .markdown-preview-view h2, .cm-header-2,
  .markdown-preview-view h3, .cm-header-3,
  .markdown-preview-view h4, .cm-header-4,
  .markdown-preview-view h5, .cm-header-5,
  .markdown-preview-view h6, .cm-header-6 {
    text-shadow: 0 0 6px rgba(255,255,255, var(--ow-glow));
  }
}
